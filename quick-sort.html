<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="icon" type="image/png" sizes="32x32" href="assets/dsa1.png">
<link rel="apple-touch-icon" href="assets/apple-touch-icon.png">
<meta name="theme-color" content="#2563eb">
<title>Quick Sort — Visualizer</title>
<style>
  footer{
    text-align: center;
  }

  :root {
    --bg:#f6f7fb; --accent:#2563eb; --compare:#f59e0b; --swap:#2563eb; --sorted:#10b981; --pivot:#f97316; --card:#fff;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Arial, sans-serif;background:var(--bg);color:#0f172a}
  header{display:flex;align-items:center;gap:12px;background:var(--accent);color:#fff;padding:12px 16px;flex-wrap:wrap}
  header .home-btn{background:transparent;border:1px solid rgba(255,255,255,0.2);color:#fff;padding:6px 10px;border-radius:8px;cursor:pointer}
  header h1{margin:0;font-size:18px;font-weight:600;flex:1}
  .wrap{max-width:1000px;margin:18px auto;padding:12px}
  .tab-buttons{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
  .tab-buttons button{padding:8px 12px;border-radius:8px;border:1px solid #e6edf8;background:#fff;cursor:pointer;font-weight:600}
  .tab-buttons button.active{background:var(--accent);color:#fff;border-color:var(--accent)}
  section.tab{display:none;background:var(--card);padding:14px;border-radius:10px;box-shadow:0 6px 18px rgba(12,15,30,0.06)}
  section.tab.active{display:block}
  .blocks-card{padding:12px;margin-top:12px}
  #blocks{display:flex;align-items:flex-end;gap:8px;min-height:180px;height:220px;justify-content:center;flex-wrap:wrap;padding:12px;background:#fbfdff;border-radius:8px;border:1px solid #e6eef8}
  .block{width:56px;height:56px;background:#c7d2fe;color:#07103b;font-weight:700;border-radius:8px;display:flex;align-items:center;justify-content:center;transition:all 260ms ease;box-shadow:0 6px 12px rgba(15,23,42,0.06)}
  .block.compare{background:var(--compare);color:#111}
  .block.swap{background:var(--swap);color:#fff}
  .block.sorted{background:var(--sorted);color:#fff}
  .block.pivot{background:var(--pivot);color:#fff}
  .controls-row{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-top:10px}
  input[type="text"]{padding:8px;border-radius:8px;border:1px solid #cbd5e1;width:220px}
  button.cta{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
  button.ghost{background:#eef2ff;border:1px solid #e2e8f0;color:#0f172a}
  .code-lines{background:#0b1220;color:#e6eef8;padding:12px;border-radius:8px;min-height:220px;overflow:auto;margin-top:12px;font-family:monospace;font-size:13px}
  .code-line.active{background:rgba(253,230,138,0.14);color:#111}
  .small{font-size:13px;color:#475569;margin-top:6px}
  @media(min-width:900px){ .visualizer-area{display:flex;gap:14px} .blocks-card,.code-card{flex:1} }
  .legend{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-top:8px}
  .legend-item{display:flex;align-items:center;gap:6px;font-size:13px}
  .legend-box{width:14px;height:14px;border-radius:3px}
</style>
</head>
<body>
<header>
  <button class="home-btn" id="homeBtn">Home</button>
  <h1>Quick Sort Visualizer</h1>
</header>

<div class="wrap">
  <div class="tab-buttons">
    <button class="tab-btn active" data-tab="overview">Overview</button>
    <button class="tab-btn" data-tab="pseudocode">Pseudocode</button>
    <button class="tab-btn" data-tab="visualizer">Visualizer</button>
  </div>

  <section id="overview" class="tab active">
    <h2>Overview</h2>
    <p>Quick Sort is a divide-and-conquer algorithm that selects a pivot, partitions the array around it, and recursively sorts the partitions. Average time O(n log n), worst O(n²).</p>
  </section>

  <section id="pseudocode" class="tab">
    <h2>Pseudocode</h2>
    <pre style="background:#f1f5f9;padding:12px;border-radius:8px;">
quickSort(arr, low, high):
  if low < high:
    pi = partition(arr, low, high)
    quickSort(arr, low, pi - 1)
    quickSort(arr, pi + 1, high)

partition(arr, low, high):
  pivot = arr[high]
  i = low - 1
  for j = low to high-1:
    if arr[j] < pivot:
      i = i + 1
      swap arr[i] and arr[j]
  swap arr[i+1] and arr[high]
  return i + 1
    </pre>
  </section>

  <section id="visualizer" class="tab">
    <h2>Visualizer</h2>

    <div class="controls-row">
      <input id="array-input" type="text" placeholder="e.g. 5,2,8,1,4">
      <button class="cta" id="set-array">Set Array</button>
      <button class="ghost" id="random-array">Random</button>
      <button class="cta" id="start-btn">Start</button>
      <button class="ghost" id="reset-btn">Reset</button>
      <label class="small">Speed:</label>
      <input type="range" id="speed" min="50" max="1000" value="400">
    </div>

    <div class="visualizer-area">
      <div class="blocks-card">
        <div class="small">low: <span id="low-val">-</span> | high: <span id="high-val">-</span> | i: <span id="i-val">-</span> | j: <span id="j-val">-</span></div>
        <div id="blocks"></div>
        <div class="legend">
          <div class="legend-item"><span class="legend-box" style="background:var(--compare)"></span> Compare</div>
          <div class="legend-item"><span class="legend-box" style="background:var(--swap)"></span> Swap</div>
          <div class="legend-item"><span class="legend-box" style="background:var(--pivot)"></span> Pivot</div>
          <div class="legend-item"><span class="legend-box" style="background:var(--sorted)"></span> Sorted</div>
        </div>
      </div>

      <div class="code-card">
        <div class="code-lines" id="code-lines"></div>
      </div>
    </div>
  </section>
</div>

<script>
(() => {
  // Tabs + Home
  const tabBtns = document.querySelectorAll('.tab-btn');
  const tabs = document.querySelectorAll('.tab');
  const homeBtn = document.getElementById('homeBtn');
  tabBtns.forEach(btn => btn.addEventListener('click', ()=>{
    const t = btn.dataset.tab;
    tabBtns.forEach(b=>b.classList.toggle('active', b===btn));
    tabs.forEach(tab=>tab.classList.toggle('active', tab.id===t));
    document.getElementById(t).scrollIntoView({behavior:'smooth',block:'start'});
  }));
  homeBtn.addEventListener('click', ()=> window.location.href='index.html');

  // Visualizer elements
  const blocksEl = document.getElementById('blocks');
  const arrayInput = document.getElementById('array-input');
  const setArrayBtn = document.getElementById('set-array');
  const randomBtn = document.getElementById('random-array');
  const startBtn = document.getElementById('start-btn');
  const resetBtn = document.getElementById('reset-btn');
  const speedInput = document.getElementById('speed');
  const lowVal = document.getElementById('low-val');
  const highVal = document.getElementById('high-val');
  const iVal = document.getElementById('i-val');
  const jVal = document.getElementById('j-val');
  const codeLinesEl = document.getElementById('code-lines');

  // State
  let arr = [5,2,8,1,4];
  let running = false;
  let speed = Number(speedInput.value);

  // C code lines for panel
  const code = [
`void quickSort(int arr[], int low, int high) {`,
`  if (low < high) {`,
`    int pi = partition(arr, low, high);`,
`    quickSort(arr, low, pi - 1);`,
`    quickSort(arr, pi + 1, high);`,
`  }`,
`}`,
`int partition(int arr[], int low, int high) {`,
`  int pivot = arr[high];`,
`  int i = (low - 1);`,
`  for (int j = low; j < high; j++) {`,
`    if (arr[j] < pivot) {`,
`      i++;`,
`      swap(arr[i], arr[j]);`,
`    }`,
`  }`,
`  swap(arr[i + 1], arr[high]);`,
`  return (i + 1);`,
`}`
  ];

  function renderCode(active=-1){
    codeLinesEl.innerHTML='';
    code.forEach((ln, idx) => {
      const d = document.createElement('div');
      d.className = 'code-line' + (idx === active ? ' active' : '');
      d.textContent = ln;
      codeLinesEl.appendChild(d);
    });
  }

  // Render blocks based on state flags (priority: move > compare > pivot > sorted > default)
  function renderBlocks(state){
    blocksEl.innerHTML = '';
    arr.forEach((v, idx) => {
      const b = document.createElement('div');
      b.className = 'block';
      // decide color priority
      if ((state.move || []).includes(idx)) {
        b.classList.add('swap');
      } else if ((state.compare || []).includes(idx)) {
        b.classList.add('compare');
      } else if (idx === state.pivot) {
        b.classList.add('pivot');
      } else if ((state.sorted || []).includes(idx)) {
        b.classList.add('sorted');
      }
      b.textContent = v;
      blocksEl.appendChild(b);
    });
  }

  function sleep(ms){ return new Promise(r => setTimeout(r, ms)); }

  // Controls
  setArrayBtn.addEventListener('click', ()=>{
    const val = arrayInput.value.split(',').map(x=>parseInt(x.trim())).filter(x=>!isNaN(x));
    if (val.length > 0) { arr = val; renderBlocks({sorted:[],compare:[],move:[],pivot:-1}); renderCode(); }
  });

  randomBtn.addEventListener('click', ()=>{
    arr = Array.from({length:6}, ()=>Math.floor(Math.random()*90)+1);
    renderBlocks({sorted:[],compare:[],move:[],pivot:-1});
    renderCode();
  });

  speedInput.addEventListener('input', () => speed = Number(speedInput.value));

  resetBtn.addEventListener('click', ()=>{
    running = false;
    arr = [5,2,8,1,4];
    renderBlocks({sorted:[],compare:[],move:[],pivot:-1});
    renderCode();
    lowVal.textContent = '-'; highVal.textContent = '-'; iVal.textContent = '-'; jVal.textContent = '-';
  });

  // Partition with state updates and safe awaiting
  async function partition(low, high, sortedIndices){
    let pivotVal = arr[high];
    // show pivot
    renderBlocks({sorted:sortedIndices, compare:[], move:[], pivot:high});
    renderCode(6); // pivot assignment line in provided C array (approx)
    await sleep(speed);

    let i = low - 1;
    for (let j = low; j < high; j++){
      // comparing j with pivot
      lowVal.textContent = low; highVal.textContent = high; iVal.textContent = i; jVal.textContent = j;
      renderBlocks({sorted:sortedIndices, compare:[j], move:[], pivot:high});
      renderCode(8); // for loop / compare line
      await sleep(speed);

      if (arr[j] < pivotVal){
        i++;
        // swap arr[i] and arr[j]
        [arr[i], arr[j]] = [arr[j], arr[i]];
        renderBlocks({sorted:sortedIndices, compare:[], move:[i,j], pivot:high});
        renderCode(10); // swap line
        await sleep(speed);
      }
      // reset color for j (will be rendered next loop)
      renderBlocks({sorted:sortedIndices, compare:[], move:[], pivot:high});
    }

    // final swap pivot into place
    [arr[i+1], arr[high]] = [arr[high], arr[i+1]];
    renderBlocks({sorted:sortedIndices, compare:[], move:[i+1, high], pivot:i+1});
    renderCode(12); // final swap
    await sleep(speed);

    // pivot is finalized
    const pivotIndex = i+1;
    sortedIndices = Array.from(new Set([...sortedIndices, pivotIndex]));
    renderBlocks({sorted:sortedIndices, compare:[], move:[], pivot:-1});
    await sleep(speed);
    return { pivotIndex, sortedIndices };
  }

  // Async QuickSort with awaited recursion
  async function quickSortViz(low, high, sortedIndices){
    if (!running) return sortedIndices;
    if (low < high){
      renderCode(0); // quickSort function start
      const res = await partition(low, high, sortedIndices);
      const pi = res.pivotIndex;
      sortedIndices = res.sortedIndices.slice(); // copy
      // left
      sortedIndices = await quickSortViz(low, pi - 1, sortedIndices);
      // right
      sortedIndices = await quickSortViz(pi + 1, high, sortedIndices);
      return sortedIndices;
    }
    return sortedIndices;
  }

  // Start handler
  startBtn.addEventListener('click', async ()=>{
    if (running) return;
    if (arr.length <= 1) return;
    running = true;
    renderCode();
    renderBlocks({sorted:[],compare:[],move:[],pivot:-1});
    const finalSorted = await quickSortViz(0, arr.length - 1, []);
    // ensure all final green
    renderBlocks({sorted: Array.from({length:arr.length}, (_,k)=>k), compare:[], move:[], pivot:-1});
    lowVal.textContent = '-'; highVal.textContent = '-'; iVal.textContent = '-'; jVal.textContent = '-';
    running = false;
  });

  // initial render
  renderBlocks({sorted:[],compare:[],move:[],pivot:-1});
  renderCode();
})();
</script>
 <footer>
  <p>Made with ❤️ by Ngroups</p>
  <p><a href="mailto:ngroups.ng@gmail.com">If any issues mail to this email.(Click me)</a></p>
</footer>
</body>
</html>
